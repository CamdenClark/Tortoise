{ foldl, tail, zip } = require('brazierjs/array')
{ pipeline         } = require('brazierjs/function')

parse = require('csv-parse/lib/sync')

# (String) => Boolean
parseBool = (x) ->
  x.toLowerCase() is "true"

# Only used to mark things that we should delay converting until later --JAB (4/6/17)
# [T] @ (T) => T
identity = (x) ->
  x

# (Object[String => Any]) => (String) => (String => Any)
converterFromSchema = (schema) -> (key) ->
  schema[key]

# (String) => String
parseString = (str) ->
  match = str.match(/^"(.*)"$/)
  if match?
    match[1]
  else
    throw new Error("Failed to match on #{str}")

attributeParser = {
  'PLOTS': {
    'autoplot?':      parseBool
  , color:            parseFloat
  , 'current pen':    parseString
  , interval:         parseFloat
  , 'legend open?':   parseBool
  , mode:             parseInt
  , 'number of pens': parseInt
  , 'pen down?':      parseBool
  , 'pen name':       parseString
  , 'x max':          parseFloat
  , 'x min':          parseFloat
  , x:                parseFloat
  , 'y max':          parseFloat
  , 'y min':          parseFloat
  , y:                parseFloat
  }
  'RANDOM STATE': {
    value: identity
  }
  'GLOBALS': {
    'directed-links': parseString
    'min-pxcor':      parseInt
    'max-pxcor':      parseInt
    'min-pycor':      parseInt
    'max-pycor':      parseInt
    nextIndex:        parseInt
    perspective:      parseInt
    subject:          identity
    ticks:            parseFloat
  }
  'TURTLES': {
    breed:         identity
  , color:         parseFloat
  , heading:       parseFloat
  , 'hidden?':     parseBool
  , 'label-color': parseFloat
  , label:         identity
  , 'pen-mode':    parseString
  , 'pen-size':    parseFloat
  , shape:         parseString
  , size:          parseFloat
  , who:           parseInt
  , xcor:          parseFloat
  , ycor:          parseFloat
  }
  'PATCHES': {
    pcolor:         parseFloat
  , 'plabel-color': parseFloat
  , plabel:         identity
  , pxcor:          parseInt
  , pycor:          parseInt
  }
  'LINKS': {
    breed:         identity
  , color:         parseFloat
  , end1:          identity
  , end2:          identity
  , 'hidden?':     parseBool
  , 'label-color': parseFloat
  , label:         identity
  , shape:         parseString
  , thickness:     parseFloat
  , 'tie-mode':    parseString
  }
  'OUTPUT': {
    value: parseString
  }
  'EXTENSIONS': {}
}

builtInGlobals = ['min-pxcor', 'max-pxcor', 'min-pycor', 'max-pycor', 'perspective', 'subject', 'nextIndex', 'directed-links', 'ticks']

oneOutput = (csvBucket, schema) ->
  converterFromSchema(schema)("value")(csvBucket[0][0])

# (Array[Array[String]], ) => Array[Object[Any]]
standardParse = (csvBucket, schema) ->

  converter = converterFromSchema(schema)
  [keys, rows...] = csvBucket

  f =
    (acc, row) ->
      obj = { extraVars: {} }
      for key, index in keys
        value = row[index]
        if schema[key]?
          obj[key] = converter(key)(value)
        else
          obj.extraVars[key] = identity(value)
      acc.concat([obj])

  foldl(f)([])(rows)

# (Array[Array[Any]], Object[Any]) => Object[Any]
globalParse = (csvBucket, schema) ->
  head = standardParse(csvBucket, schema)[0]
  delete head.extraVars
  head

plotParse = (csvBucket, schema) ->
  output = {}
  converter = converterFromSchema(schema)

  output['plots'] = []
  output['default'] = if csvBucket.length == 0 then null else csvBucket[0][0]

  #Iterate over every plot
  csvIndex = 1
  while csvIndex < csvBucket.length
    plot = {}
    plot['name'] = parseString(csvBucket[csvIndex][0])
    csvIndex++

    #Parsing of the global attributes in each plot
    for plotAttributeIndex in [0...csvBucket[csvIndex].length]
      plot[csvBucket[csvIndex][plotAttributeIndex]] = converter(csvBucket[csvIndex][plotAttributeIndex])(csvBucket[csvIndex + 1][plotAttributeIndex])
    csvIndex += 2

    #Parsing of the attributes of each pen in a plot
    plot['pens'] = []
    numPens = parseInt(plot['number of pens'])
    for penIndex in [0...numPens]
      pen = {}
      for penAttributeIndex in [0...csvBucket[csvIndex].length]
        pen[csvBucket[csvIndex][penAttributeIndex]] = converter(csvBucket[csvIndex][penAttributeIndex])(csvBucket[csvIndex + penIndex + 1][penAttributeIndex])
      pen['points'] = []
      plot['pens'].push(pen)
    csvIndex += 2 + numPens

    #For each pen, parsing of the list of points associated with the pen
    pointsIndex = 1
    while csvIndex + pointsIndex < csvBucket.length and csvBucket[csvIndex + pointsIndex].length != 1
      for penIndex in [0...numPens]
        point = {}
        length = csvBucket[csvIndex].length / numPens
        for pointAttributeIndex in [0...length]
          point[csvBucket[csvIndex][pointAttributeIndex]] = converter(csvBucket[csvIndex][pointAttributeIndex])(csvBucket[csvIndex + pointsIndex][length * penIndex + pointAttributeIndex])
        plot['pens'][penIndex]['points'].push(point)
      pointsIndex++
    csvIndex += pointsIndex

    output['plots'].push(plot)
  output

extensionParse = (csvBucket, schema) ->
  output = {}
  extension = ''
  for entry in csvBucket
    item = entry[0]
    if !item.startsWith('{{')
      extension = item
      output[extension] = []
    else
      output[extension].push(item)
  output

extractGlobals = (globals) ->
  builtIn = {}
  user = {}
  for global of globals
    if global in builtInGlobals
      builtIn[global] = globals[global]
    else
      user[global] = globals[global]
  [builtIn, user]

buckets = {
  'RANDOM STATE': oneOutput
  'GLOBALS': globalParse
  'TURTLES': standardParse
  'PATCHES': standardParse
  'LINKS': standardParse
  'OUTPUT': oneOutput
  'PLOTS': plotParse
  'EXTENSIONS': extensionParse
}

module.exports = () ->

  parsedCSV = parse(testCSV, {
    comment: '#'
    skip_empty_lines: true
    relax_column_count: true
  })

  world = {}

  clusterRows = ([acc, latestRows], bucketName) ->
    if bucketName of buckets
      rows = []
      acc[bucketName] = rows
      [acc, rows]
    else if latestRows?
      latestRows.push(bucketName)
      [acc, latestRows]
    else
      [acc, latestRows]

  [bucketToRows, _] = foldl(clusterRows)([{}, undefined])(parsedCSV)

  for key, bucketParser of buckets
    world[key] = bucketParser(bucketToRows[key], attributeParser[key])

  globals = extractGlobals(world["GLOBALS"])
  world["USER GLOBALS"] = globals[1]
  world["BUILT-IN GLOBALS"] = globals[0]
  delete world["GLOBALS"]

  world

testCSV = '''
"export-world data (NetLogo 6.0-BETA1)"
"PD Two Person Iterated.nlogo"
"03/30/2017 11:37:14:082 -0500"

"RANDOM STATE"
"0 0 -1727483681 40 0.0 false -1908908735 -1894096807 -2105889829 1208341474 -2044285135 247102942 -1016077898 143009541 -1267788515 565917152 557904158 1434688120 -194385135 -1366549010 1535269687 -648896365 -1985615970 -1547751903 420493766 -1225733296 -882127218 1098616710 295251237 -1923565779 -1113793636 820499799 2097631564 255786263 -348207855 -408069367 -1692761730 -1059469875 -1734741728 -1053908444 -806194840 434114741 -2106313388 2003182176 -848744709 1885540392 -1311603722 992146590 466596959 1516324896 592638905 -1729365750 -350925527 -420311533 -1907753787 1191961586 -239856444 1792204193 -466782111 -1167565536 -1022296989 1766152677 -138547555 1109306421 432977385 -1199223117 -510816084 1579182420 392195568 212094532 446339178 1369983106 -563685433 1398025326 911580666 -275537160 1240886054 1387274495 1930834136 -1448445930 498919845 -1729498025 1472544976 1615977847 848073351 -1029842265 1345542910 1796841250 1155909987 185982972 -1201754213 1652630144 -102187190 -1314739031 918014613 -2113444525 1136620713 -141387966 1228031787 1107109053 60040151 -1765536446 -1976148093 -1192807873 2036355317 1855132847 -318758407 -416314806 -431817408 -1689384281 -416249987 2022126623 1118248200 1968191398 591669833 2091206174 -444479210 -1373387036 1359567644 1687762132 1581704994 -1968632771 1751013866 -2026645004 813121918 1326143894 -334983965 840999659 1240461417 2055877951 878298489 -1393800165 -1026588751 1256945918 -1490255368 -1826648196 834652787 -1273793712 -603727290 -1107606688 -1025043198 1109671140 1655616752 705340184 233697530 881678132 -1695799 115147551 1214709213 2046547792 -576287290 1634280362 -1799426585 360056335 87505401 733705 736975071 2104245931 -1858504677 -1440679261 1911060311 -1847100740 1170086521 -1442275360 -1102851898 1397738101 -549370539 1886011581 -1748753187 -1578889647 298518621 885947555 -628612306 2093534892 -13793667 1736168710 319758256 794621458 492019242 1083023281 646485676 1471681592 511357477 -976830215 395383939 28479552 -1626383386 575333596 -1955542768 1252998931 365867746 574255434 -1022584744 1274786609 821095140 -1776366992 1890762734 1540232115 -697835168 504080513 -286566182 217606691 -432202446 1988749156 -1097038831 923076871 340838291 -915588764 1614006048 -1509573037 -16626596 -15002390 1596010256 2116513916 1624058693 1795205198 -2040633120 1419339784 -2009543048 -180619052 443186034 -199080730 -1839400294 -120326094 743945269 466004003 1708302562 -20486480 -180935862 -38890344 211373854 -723227511 1091234784 -2094003339 868550256 -964143811 -1147907157 -1548951917 1969072296 1570141148 975860884 215479199 -302068739 -2084575118 -1561387242 -428735652 501905128 801705862 -1584595441 1744914780 1013446677 -1582978051 2021010011 296449382 1158295396 1807472681 -954867844 -368041070 -30834463 -30435059 378475679 -1395347044 689376362 835911678 1069730949 -2086471371 638514845 -522927191 215516398 -279410862 830136986 -971324452 -673394913 -176989307 -1107381084 -1024731219 8972726 1737843618 41158650 1657289008 -857681079 1072467876 -763118675 1417108390 -2052985655 -217357090 1543366781 -547142988 -1695991359 -2112891987 577932963 -979944222 -816783880 815422215 1301079891 640066980 1390216585 614204697 257404349 -2026670130 -1678182646 -54271347 -2046852852 -311864462 -820981172 -1896624306 951030186 -1184408286 236620743 -876927366 596093048 1025942531 90364522 -364366777 -1247940160 -1429932219 -1481980165 -736851038 414131687 1393803367 1169492490 2130710138 1063406693 407737742 532679936 982911751 304729257 1951526461 -1117638172 1386151275 -209393508 1438330119 1177805695 550761197 -794211036 1705384994 -1637407922 -1322109357 -1381725199 -2666119 -538032076 1416060909 1691661585 -1998017991 -892452250 -1892039736 2088714336 706022966 -188417126 -618057612 2118688711 1763115088 -1272498575 -1231544376 -1462697583 -391540020 -57618127 -1475649167 -849162294 1706578102 -1942488465 636316941 -1192094581 -2108881292 647043684 1859971204 260122778 -1955222293 -152271207 1447841872 1178829558 -948613231 1689879527 -9962178 -2120218389 -324801184 -1286003385 834835104 -1819058393 -187243107 194535839 1329941512 -1663171833 -277502849 2033636384 -804185301 1198724719 1698564201 763734102 2034501328 -1733420352 362744586 -1965057423 1257200465 388312010 2144978177 942944124 -67707433 -2057784271 -1267596817 843380116 -1933682370 2010210542 453374719 -601614272 798645571 830806578 -1209488551 1498211638 629091189 -1631954037 149307974 -832962432 612230016 -1969412406 -1167846902 2023366609 -1140226505 -1728269483 -66019625 1451643356 23508917 -1587337976 -1315959183 902241946 1020727283 -1320879984 -1046435645 2145795293 766911180 602585667 -1551752151 -1940482251 1725499489 -1824660980 318965092 -1508413427 -613419598 -2008870084 -1795656815 986361467 924771453 -118120093 493386808 1512723289 -1970073943 1167762522 1339782943 408504128 -609878612 994443388 -393645429 1717530961 -538410575 243086574 -110738036 187246627 1330495141 1972481791 796446411 -2077394440 1903827024 1894180454 -1473686446 201525614 1702317048 -1286091816 1948867709 -1218603372 -953804175 -550367410 -1246738301 754807246 -180297809 -1861235013 -2061623526 1778157243 1757996223 415126236 743998419 -717098685 -445584903 -1712001877 -192798244 -191956656 -1455805890 1181476921 1794877660 -364123086 1625067927 -1978206750 1103580664 -109195609 -1094086142 -745799346 -1051724716 -627360301 -1730137656 1794166676 -497092459 -1617344252 1295357521 1097089784 -222715413 -1645218603 1989546077 1236811936 1216981227 268795227 382179990 217627054 -1152148756 -790475881 -1062918433 -1481029079 152156604 -347282772 -221961010 -486034673 1674907155 -1730669731 10638917 -990102674 368961390 -1406365472 -1647649066 -453267730 1856724841 211008196 -246279531 -624709276 336995679 -765591083 1257733216 -1685590705 -854255793 -2074644528 348955492 1148848429 -589223171 -1441658932 -59981378 1431920061 -1991641205 -247481006 -324403475 -1423208694 1656499779 536973392 454012359 1053223203 -810501056 1679686685 1006806269 1175784660 1486746230 -688259392 1489436361 -1328380621 1562540979 -1349437533 413125219 1373507811 1176247832 -282963423 -1796067357 -1940718285 736565897 -1040372495 -1792551272 791507694 -1657036850 554053492 998942118 -1082580781 1345681396 1804020569 1378666079 95027326 130085721 2009374266 1952844128 -304898251 -723512209 -709813698 1540804074 1166117830 1516411098 1165844480 483738787 1766121113 2116514336 -800333918 1459451236 70064232 529692108 -1428166287 2050384552 -144910496 -1704673357 1563204321 -42314396 -611919064 1139790898 -802468131 -1021622436 1207314929 1175065848 -215970553 -1038892380 289803448 1542164103 -1082899381 -623419278 316638139 -132791381 1757506206 -1033037411 -539546709 613752629 -1193051269 1177480882 -364161966 -2069466752 1685839116 138436498 -374684971 1943564266 1800996275 -1446642031"

"GLOBALS"
"min-pxcor","max-pxcor","min-pycor","max-pycor","perspective","subject","nextIndex","directed-links","ticks","computer-score","computer-strategy","display-history?","hidden-strategy","human-score","human-strategy","select-computer-strategy?"
"-17","17","-8","8","0","nobody","2","""UNDIRECTED""","14","15","""tit-for-tat""","false","5","20","""random""","true"

"TURTLES"
"who","color","heading","xcor","ycor","shape","label","label-color","breed","hidden?","size","pen-size","pen-mode","score","defect-now?","partner","partner-defected?","partner-defected-past?"
"0","15","90","8.5","0","""computer""","1.154","9.9","{breed computers}","false","10","1","""up""","15","false","1","true","false"
"1","125","270","-8.5","0","""person""","1.538","9.9","{breed users}","false","10","1","""up""","20","true","0","false","true"

"PATCHES"
"pxcor","pycor","pcolor","plabel","plabel-color"
"-17","8","0","""""","9.9"
"-16","8","0","""""","9.9"
"-15","8","0","""""","9.9"
"-14","8","0","""""","9.9"
"-13","8","0","""""","9.9"
"-12","8","0","""""","9.9"
"-11","8","0","""""","9.9"
"-10","8","0","""""","9.9"
"-9","8","0","""""","9.9"
"-8","8","0","""""","9.9"
"-7","8","0","""""","9.9"
"-6","8","0","""""","9.9"
"-5","8","0","""""","9.9"
"-4","8","0","""""","9.9"
"-3","8","0","""""","9.9"
"-2","8","0","""""","9.9"
"-1","8","0","""""","9.9"
"0","8","0","""""","9.9"
"1","8","0","""""","9.9"
"2","8","0","""""","9.9"
"3","8","0","""""","9.9"
"4","8","5","""""","9.9"
"5","8","0","""""","9.9"
"6","8","0","""""","9.9"
"7","8","0","""""","9.9"
"8","8","0","""""","9.9"
"9","8","0","""""","9.9"
"10","8","0","""""","9.9"
"11","8","0","""""","9.9"
"12","8","0","""""","9.9"
"13","8","0","""""","9.9"
"14","8","0","""""","9.9"
"15","8","0","""""","9.9"
"16","8","0","""""","9.9"
"17","8","0","""""","9.9"
"-17","7","0","""""","9.9"
"-16","7","0","""""","9.9"
"-15","7","0","""""","9.9"
"-14","7","0","""""","9.9"
"-13","7","0","""""","9.9"
"-12","7","0","""""","9.9"
"-11","7","0","""""","9.9"
"-10","7","0","""""","9.9"
"-9","7","0","""""","9.9"
"-8","7","0","""""","9.9"
"-7","7","0","""""","9.9"
"-6","7","0","""""","9.9"
"-5","7","0","""""","9.9"
"-4","7","0","""""","9.9"
"-3","7","0","""""","9.9"
"-2","7","0","""""","9.9"
"-1","7","0","""""","9.9"
"0","7","0","""""","9.9"
"1","7","0","""""","9.9"
"2","7","0","""""","9.9"
"3","7","0","""""","9.9"
"4","7","0","""""","9.9"
"5","7","0","""""","9.9"
"6","7","0","""""","9.9"
"7","7","0","""""","9.9"
"8","7","0","""""","9.9"
"9","7","0","""""","9.9"
"10","7","0","""""","9.9"
"11","7","0","""""","9.9"
"12","7","0","""""","9.9"
"13","7","0","""""","9.9"
"14","7","0","""""","9.9"
"15","7","0","""""","9.9"
"16","7","0","""""","9.9"
"17","7","0","""""","9.9"
"-17","6","0","""""","9.9"
"-16","6","0","""""","9.9"
"-15","6","0","""""","9.9"
"-14","6","0","""""","9.9"
"-13","6","0","""""","9.9"
"-12","6","0","""""","9.9"
"-11","6","0","""""","9.9"
"-10","6","0","""""","9.9"
"-9","6","0","""""","9.9"
"-8","6","0","""""","9.9"
"-7","6","0","""""","9.9"
"-6","6","0","""""","9.9"
"-5","6","0","""""","9.9"
"-4","6","0","""""","9.9"
"-3","6","0","""""","9.9"
"-2","6","0","""""","9.9"
"-1","6","0","""""","9.9"
"0","6","0","""""","9.9"
"1","6","0","""""","9.9"
"2","6","0","""""","9.9"
"3","6","0","""""","9.9"
"4","6","0","""""","9.9"
"5","6","0","""""","9.9"
"6","6","0","""""","9.9"
"7","6","0","""""","9.9"
"8","6","0","""""","9.9"
"9","6","0","""""","9.9"
"10","6","0","""""","9.9"
"11","6","0","""""","9.9"
"12","6","0","""""","9.9"
"13","6","0","""""","9.9"
"14","6","0","""""","9.9"
"15","6","0","""""","9.9"
"16","6","0","""""","9.9"
"17","6","0","""""","9.9"
"-17","5","0","""""","9.9"
"-16","5","0","""""","9.9"
"-15","5","0","""""","9.9"
"-14","5","0","""""","9.9"
"-13","5","0","""""","9.9"
"-12","5","0","""""","9.9"
"-11","5","0","""""","9.9"
"-10","5","0","""""","9.9"
"-9","5","0","""""","9.9"
"-8","5","0","""""","9.9"
"-7","5","0","""""","9.9"
"-6","5","0","""""","9.9"
"-5","5","0","""""","9.9"
"-4","5","0","""""","9.9"
"-3","5","0","""""","9.9"
"-2","5","0","""""","9.9"
"-1","5","0","""""","9.9"
"0","5","0","""""","9.9"
"1","5","0","""""","9.9"
"2","5","0","""""","9.9"
"3","5","0","""""","9.9"
"4","5","0","""""","9.9"
"5","5","0","""""","9.9"
"6","5","0","""""","9.9"
"7","5","0","""""","9.9"
"8","5","0","""""","9.9"
"9","5","0","""""","9.9"
"10","5","0","""""","9.9"
"11","5","0","""""","9.9"
"12","5","0","""""","9.9"
"13","5","0","""""","9.9"
"14","5","0","""""","9.9"
"15","5","0","""""","9.9"
"16","5","0","""""","9.9"
"17","5","0","""""","9.9"
"-17","4","0","""""","9.9"
"-16","4","0","""""","9.9"
"-15","4","0","""""","9.9"
"-14","4","0","""""","9.9"
"-13","4","0","""""","9.9"
"-12","4","0","""""","9.9"
"-11","4","0","""""","9.9"
"-10","4","0","""""","9.9"
"-9","4","0","""""","9.9"
"-8","4","0","""""","9.9"
"-7","4","0","""""","9.9"
"-6","4","0","""""","9.9"
"-5","4","0","""""","9.9"
"-4","4","0","""""","9.9"
"-3","4","0","""""","9.9"
"-2","4","0","""""","9.9"
"-1","4","0","""""","9.9"
"0","4","0","""""","9.9"
"1","4","0","""""","9.9"
"2","4","0","""""","9.9"
"3","4","0","""""","9.9"
"4","4","0","""""","9.9"
"5","4","0","""""","9.9"
"6","4","0","""""","9.9"
"7","4","0","""""","9.9"
"8","4","0","""""","9.9"
"9","4","0","""""","9.9"
"10","4","0","""""","9.9"
"11","4","0","""""","9.9"
"12","4","0","""""","9.9"
"13","4","0","""""","9.9"
"14","4","0","""""","9.9"
"15","4","0","""""","9.9"
"16","4","0","""""","9.9"
"17","4","0","""""","9.9"
"-17","3","0","""""","9.9"
"-16","3","0","""""","9.9"
"-15","3","0","""""","9.9"
"-14","3","0","""""","9.9"
"-13","3","0","""""","9.9"
"-12","3","0","""""","9.9"
"-11","3","0","""""","9.9"
"-10","3","0","""""","9.9"
"-9","3","0","""""","9.9"
"-8","3","0","""""","9.9"
"-7","3","0","""""","9.9"
"-6","3","0","""""","9.9"
"-5","3","0","""""","9.9"
"-4","3","0","""""","9.9"
"-3","3","0","""""","9.9"
"-2","3","0","""""","9.9"
"-1","3","0","""""","9.9"
"0","3","0","""""","9.9"
"1","3","0","""""","9.9"
"2","3","0","""""","9.9"
"3","3","0","""""","9.9"
"4","3","0","""""","9.9"
"5","3","0","""""","9.9"
"6","3","0","""""","9.9"
"7","3","0","""""","9.9"
"8","3","0","""""","9.9"
"9","3","0","""""","9.9"
"10","3","0","""""","9.9"
"11","3","0","""""","9.9"
"12","3","0","""""","9.9"
"13","3","0","""""","9.9"
"14","3","0","""""","9.9"
"15","3","0","""""","9.9"
"16","3","0","""""","9.9"
"17","3","0","""""","9.9"
"-17","2","0","""""","9.9"
"-16","2","0","""""","9.9"
"-15","2","0","""""","9.9"
"-14","2","0","""""","9.9"
"-13","2","0","""""","9.9"
"-12","2","0","""""","9.9"
"-11","2","0","""""","9.9"
"-10","2","0","""""","9.9"
"-9","2","0","""""","9.9"
"-8","2","0","""""","9.9"
"-7","2","0","""""","9.9"
"-6","2","0","""""","9.9"
"-5","2","0","""""","9.9"
"-4","2","0","""""","9.9"
"-3","2","0","""""","9.9"
"-2","2","0","""""","9.9"
"-1","2","0","""""","9.9"
"0","2","0","""""","9.9"
"1","2","0","""""","9.9"
"2","2","0","""""","9.9"
"3","2","0","""""","9.9"
"4","2","0","""""","9.9"
"5","2","0","""""","9.9"
"6","2","0","""""","9.9"
"7","2","0","""""","9.9"
"8","2","0","""""","9.9"
"9","2","0","""""","9.9"
"10","2","0","""""","9.9"
"11","2","0","""""","9.9"
"12","2","0","""""","9.9"
"13","2","0","""""","9.9"
"14","2","0","""""","9.9"
"15","2","0","""""","9.9"
"16","2","0","""""","9.9"
"17","2","0","""""","9.9"
"-17","1","0","""""","9.9"
"-16","1","0","""""","9.9"
"-15","1","0","""""","9.9"
"-14","1","0","""""","9.9"
"-13","1","0","""""","9.9"
"-12","1","0","""""","9.9"
"-11","1","0","""""","9.9"
"-10","1","0","""""","9.9"
"-9","1","0","""""","9.9"
"-8","1","0","""""","9.9"
"-7","1","0","""""","9.9"
"-6","1","0","""""","9.9"
"-5","1","0","""""","9.9"
"-4","1","0","""""","9.9"
"-3","1","0","""""","9.9"
"-2","1","0","""""","9.9"
"-1","1","0","""""","9.9"
"0","1","0","""""","9.9"
"1","1","0","""""","9.9"
"2","1","0","""""","9.9"
"3","1","0","""""","9.9"
"4","1","0","""""","9.9"
"5","1","0","""""","9.9"
"6","1","0","""""","9.9"
"7","1","0","""""","9.9"
"8","1","0","""""","9.9"
"9","1","0","""""","9.9"
"10","1","0","""""","9.9"
"11","1","0","""""","9.9"
"12","1","0","""""","9.9"
"13","1","0","""""","9.9"
"14","1","0","""""","9.9"
"15","1","0","""""","9.9"
"16","1","0","""""","9.9"
"17","1","0","""""","9.9"
"-17","0","0","""""","9.9"
"-16","0","0","""""","9.9"
"-15","0","0","""""","9.9"
"-14","0","0","""""","9.9"
"-13","0","0","""""","9.9"
"-12","0","0","""""","9.9"
"-11","0","0","""""","9.9"
"-10","0","0","""""","9.9"
"-9","0","0","""""","9.9"
"-8","0","0","""""","9.9"
"-7","0","0","""""","9.9"
"-6","0","0","""""","9.9"
"-5","0","0","""""","9.9"
"-4","0","0","""""","9.9"
"-3","0","0","""""","9.9"
"-2","0","0","""""","9.9"
"-1","0","0","""""","9.9"
"0","0","0","""""","9.9"
"1","0","0","""""","9.9"
"2","0","0","""""","9.9"
"3","0","0","""""","9.9"
"4","0","0","""""","9.9"
"5","0","0","""""","9.9"
"6","0","0","""""","9.9"
"7","0","0","""""","9.9"
"8","0","0","""""","9.9"
"9","0","0","""""","9.9"
"10","0","0","""""","9.9"
"11","0","0","""""","9.9"
"12","0","0","""""","9.9"
"13","0","0","""""","9.9"
"14","0","0","""""","9.9"
"15","0","0","""""","9.9"
"16","0","0","""""","9.9"
"17","0","0","""""","9.9"
"-17","-1","0","""""","9.9"
"-16","-1","0","""""","9.9"
"-15","-1","0","""""","9.9"
"-14","-1","0","""""","9.9"
"-13","-1","0","""""","9.9"
"-12","-1","0","""""","9.9"
"-11","-1","0","""""","9.9"
"-10","-1","0","""""","9.9"
"-9","-1","0","""""","9.9"
"-8","-1","0","""""","9.9"
"-7","-1","0","""""","9.9"
"-6","-1","0","""""","9.9"
"-5","-1","0","""""","9.9"
"-4","-1","0","""""","9.9"
"-3","-1","0","""""","9.9"
"-2","-1","0","""""","9.9"
"-1","-1","0","""""","9.9"
"0","-1","0","""""","9.9"
"1","-1","0","""""","9.9"
"2","-1","0","""""","9.9"
"3","-1","0","""""","9.9"
"4","-1","0","""""","9.9"
"5","-1","0","""""","9.9"
"6","-1","0","""""","9.9"
"7","-1","0","""""","9.9"
"8","-1","0","""""","9.9"
"9","-1","0","""""","9.9"
"10","-1","0","""""","9.9"
"11","-1","0","""""","9.9"
"12","-1","0","""""","9.9"
"13","-1","0","""""","9.9"
"14","-1","0","""""","9.9"
"15","-1","0","""""","9.9"
"16","-1","0","""""","9.9"
"17","-1","0","""""","9.9"
"-17","-2","0","""""","9.9"
"-16","-2","0","""""","9.9"
"-15","-2","0","""""","9.9"
"-14","-2","0","""""","9.9"
"-13","-2","0","""""","9.9"
"-12","-2","0","""""","9.9"
"-11","-2","0","""""","9.9"
"-10","-2","0","""""","9.9"
"-9","-2","0","""""","9.9"
"-8","-2","0","""""","9.9"
"-7","-2","0","""""","9.9"
"-6","-2","0","""""","9.9"
"-5","-2","0","""""","9.9"
"-4","-2","0","""""","9.9"
"-3","-2","0","""""","9.9"
"-2","-2","0","""""","9.9"
"-1","-2","0","""""","9.9"
"0","-2","0","""""","9.9"
"1","-2","0","""""","9.9"
"2","-2","0","""""","9.9"
"3","-2","0","""""","9.9"
"4","-2","0","""""","9.9"
"5","-2","0","""""","9.9"
"6","-2","0","""""","9.9"
"7","-2","0","""""","9.9"
"8","-2","0","""""","9.9"
"9","-2","0","""""","9.9"
"10","-2","0","""""","9.9"
"11","-2","0","""""","9.9"
"12","-2","0","""""","9.9"
"13","-2","0","""""","9.9"
"14","-2","0","""""","9.9"
"15","-2","0","""""","9.9"
"16","-2","0","""""","9.9"
"17","-2","0","""""","9.9"
"-17","-3","0","""""","9.9"
"-16","-3","0","""""","9.9"
"-15","-3","0","""""","9.9"
"-14","-3","0","""""","9.9"
"-13","-3","0","""""","9.9"
"-12","-3","0","""""","9.9"
"-11","-3","0","""""","9.9"
"-10","-3","0","""""","9.9"
"-9","-3","0","""""","9.9"
"-8","-3","0","""""","9.9"
"-7","-3","0","""""","9.9"
"-6","-3","0","""""","9.9"
"-5","-3","0","""""","9.9"
"-4","-3","0","""""","9.9"
"-3","-3","0","""""","9.9"
"-2","-3","0","""""","9.9"
"-1","-3","0","""""","9.9"
"0","-3","0","""""","9.9"
"1","-3","0","""""","9.9"
"2","-3","0","""""","9.9"
"3","-3","0","""""","9.9"
"4","-3","0","""""","9.9"
"5","-3","0","""""","9.9"
"6","-3","0","""""","9.9"
"7","-3","0","""""","9.9"
"8","-3","0","""""","9.9"
"9","-3","0","""""","9.9"
"10","-3","0","""""","9.9"
"11","-3","0","""""","9.9"
"12","-3","0","""""","9.9"
"13","-3","0","""""","9.9"
"14","-3","0","""""","9.9"
"15","-3","0","""""","9.9"
"16","-3","0","""""","9.9"
"17","-3","0","""""","9.9"
"-17","-4","0","""""","9.9"
"-16","-4","0","""""","9.9"
"-15","-4","0","""""","9.9"
"-14","-4","0","""""","9.9"
"-13","-4","0","""""","9.9"
"-12","-4","0","""""","9.9"
"-11","-4","0","""""","9.9"
"-10","-4","0","""""","9.9"
"-9","-4","0","""""","9.9"
"-8","-4","0","""""","9.9"
"-7","-4","0","""""","9.9"
"-6","-4","0","""""","9.9"
"-5","-4","0","""""","9.9"
"-4","-4","0","""""","9.9"
"-3","-4","0","""""","9.9"
"-2","-4","0","""""","9.9"
"-1","-4","0","""""","9.9"
"0","-4","0","""""","9.9"
"1","-4","0","""""","9.9"
"2","-4","0","""""","9.9"
"3","-4","0","""""","9.9"
"4","-4","0","""""","9.9"
"5","-4","0","""""","9.9"
"6","-4","0","""""","9.9"
"7","-4","0","""""","9.9"
"8","-4","0","""""","9.9"
"9","-4","0","""""","9.9"
"10","-4","0","""""","9.9"
"11","-4","0","""""","9.9"
"12","-4","0","""""","9.9"
"13","-4","0","""""","9.9"
"14","-4","0","""""","9.9"
"15","-4","0","""""","9.9"
"16","-4","0","""""","9.9"
"17","-4","0","""""","9.9"
"-17","-5","0","""""","9.9"
"-16","-5","0","""""","9.9"
"-15","-5","0","""""","9.9"
"-14","-5","0","""""","9.9"
"-13","-5","0","""""","9.9"
"-12","-5","0","""""","9.9"
"-11","-5","0","""""","9.9"
"-10","-5","0","""""","9.9"
"-9","-5","0","""""","9.9"
"-8","-5","0","""""","9.9"
"-7","-5","0","""""","9.9"
"-6","-5","0","""""","9.9"
"-5","-5","0","""""","9.9"
"-4","-5","0","""""","9.9"
"-3","-5","0","""""","9.9"
"-2","-5","0","""""","9.9"
"-1","-5","0","""""","9.9"
"0","-5","0","""""","9.9"
"1","-5","0","""""","9.9"
"2","-5","0","""""","9.9"
"3","-5","0","""""","9.9"
"4","-5","0","""""","9.9"
"5","-5","0","""""","9.9"
"6","-5","0","""""","9.9"
"7","-5","0","""""","9.9"
"8","-5","0","""""","9.9"
"9","-5","0","""""","9.9"
"10","-5","0","""""","9.9"
"11","-5","0","""""","9.9"
"12","-5","0","""""","9.9"
"13","-5","0","""""","9.9"
"14","-5","0","""""","9.9"
"15","-5","0","""""","9.9"
"16","-5","0","""""","9.9"
"17","-5","0","""""","9.9"
"-17","-6","0","""""","9.9"
"-16","-6","0","""""","9.9"
"-15","-6","0","""""","9.9"
"-14","-6","0","""""","9.9"
"-13","-6","0","""""","9.9"
"-12","-6","0","""""","9.9"
"-11","-6","0","""""","9.9"
"-10","-6","0","""""","9.9"
"-9","-6","0","""""","9.9"
"-8","-6","0","""""","9.9"
"-7","-6","0","""""","9.9"
"-6","-6","0","""""","9.9"
"-5","-6","0","""""","9.9"
"-4","-6","0","""""","9.9"
"-3","-6","0","""""","9.9"
"-2","-6","0","""""","9.9"
"-1","-6","0","""""","9.9"
"0","-6","0","""""","9.9"
"1","-6","0","""""","9.9"
"2","-6","0","""""","9.9"
"3","-6","0","""""","9.9"
"4","-6","0","""""","9.9"
"5","-6","0","""""","9.9"
"6","-6","0","""""","9.9"
"7","-6","0","""""","9.9"
"8","-6","0","""""","9.9"
"9","-6","0","""""","9.9"
"10","-6","0","""""","9.9"
"11","-6","0","""""","9.9"
"12","-6","0","""""","9.9"
"13","-6","0","""""","9.9"
"14","-6","0","""""","9.9"
"15","-6","0","""""","9.9"
"16","-6","0","""""","9.9"
"17","-6","0","""""","9.9"
"-17","-7","0","""""","9.9"
"-16","-7","0","""""","9.9"
"-15","-7","0","""""","9.9"
"-14","-7","0","""""","9.9"
"-13","-7","0","""""","9.9"
"-12","-7","0","""""","9.9"
"-11","-7","0","""""","9.9"
"-10","-7","0","""""","9.9"
"-9","-7","0","""""","9.9"
"-8","-7","0","""""","9.9"
"-7","-7","0","""""","9.9"
"-6","-7","0","""""","9.9"
"-5","-7","0","""""","9.9"
"-4","-7","0","""""","9.9"
"-3","-7","0","""""","9.9"
"-2","-7","0","""""","9.9"
"-1","-7","0","""""","9.9"
"0","-7","0","""""","9.9"
"1","-7","0","""""","9.9"
"2","-7","0","""""","9.9"
"3","-7","0","""""","9.9"
"4","-7","0","""""","9.9"
"5","-7","0","""""","9.9"
"6","-7","0","""""","9.9"
"7","-7","0","""""","9.9"
"8","-7","0","""""","9.9"
"9","-7","0","""""","9.9"
"10","-7","0","""""","9.9"
"11","-7","0","""""","9.9"
"12","-7","0","""""","9.9"
"13","-7","0","""""","9.9"
"14","-7","0","""""","9.9"
"15","-7","0","""""","9.9"
"16","-7","0","""""","9.9"
"17","-7","0","""""","9.9"
"-17","-8","0","""""","9.9"
"-16","-8","0","""""","9.9"
"-15","-8","0","""""","9.9"
"-14","-8","0","""""","9.9"
"-13","-8","0","""""","9.9"
"-12","-8","0","""""","9.9"
"-11","-8","0","""""","9.9"
"-10","-8","0","""""","9.9"
"-9","-8","0","""""","9.9"
"-8","-8","0","""""","9.9"
"-7","-8","0","""""","9.9"
"-6","-8","0","""""","9.9"
"-5","-8","0","""""","9.9"
"-4","-8","0","""""","9.9"
"-3","-8","0","""""","9.9"
"-2","-8","0","""""","9.9"
"-1","-8","0","""""","9.9"
"0","-8","0","""""","9.9"
"1","-8","0","""""","9.9"
"2","-8","0","""""","9.9"
"3","-8","0","""""","9.9"
"4","-8","0","""""","9.9"
"5","-8","0","""""","9.9"
"6","-8","0","""""","9.9"
"7","-8","0","""""","9.9"
"8","-8","0","""""","9.9"
"9","-8","0","""""","9.9"
"10","-8","0","""""","9.9"
"11","-8","0","""""","9.9"
"12","-8","0","""""","9.9"
"13","-8","0","""""","9.9"
"14","-8","0","""""","9.9"
"15","-8","0","""""","9.9"
"16","-8","0","""""","9.9"
"17","-8","0","""""","9.9"

"LINKS"
"end1","end2","color","label","label-color","hidden?","breed","thickness","shape","tie-mode"
"{computer 0}","{user 1}","5","""""","9.9","false","{all-links}","0","""default""","""none"""


"OUTPUT"
"""someasdfasdfqwf"""
"PLOTS"
"Average Score"
"""Average Score"""
"x min","x max","y min","y max","autoplot?","current pen","legend open?","number of pens"
"0","17.5","0","5","true","""human""","false","2"

"pen name","pen down?","mode","interval","color","x"
"""human""","true","0","1","0","14"
"""computer""","true","0","1","105","14"

"""human""",,,,"""computer"""
"x","y","color","pen down?","x","y","color","pen down?"
"0","3","0","true","0","3","105","true"
"1","3","0","true","1","3","105","true"
"2","5","0","true","2","0","105","true"
"3","5","0","true","3","0","105","true"
"4","1.667","0","true","4","1.667","105","true"
"5","1.667","0","true","5","1.667","105","true"
"6","2","0","true","6","1","105","true"
"7","2","0","true","7","1","105","true"
"8","1.429","0","true","8","1.429","105","true"
"9","1.429","0","true","9","1.429","105","true"
"10","1.667","0","true","10","1.111","105","true"
"11","1.667","0","true","11","1.111","105","true"
"12","1.364","0","true","12","1.364","105","true"
"13","1.364","0","true","13","1.364","105","true"
"14","1.538","0","true","14","1.154","105","true"

"EXTENSIONS"

'''
